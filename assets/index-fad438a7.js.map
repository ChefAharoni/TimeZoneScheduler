{"version":3,"file":"index-fad438a7.js","sources":["../../script.js"],"sourcesContent":["// script.js\n(() => {\n  const { DateTime } = luxon;\n  const baseTzSelect = document.getElementById(\"base-tz\");\n  const targetTzSelect = document.getElementById(\"target-tz\");\n  const timezoneSearch = document.getElementById(\"timezone-search\");\n  const tzSelectedFeedback = document.getElementById(\"target-tz-selected\");\n  const dateInput = document.getElementById(\"date\");\n  const timeInput = document.getElementById(\"time\");\n  const endDateInput = document.getElementById(\"end-date\");\n  const endTimeInput = document.getElementById(\"end-time\");\n  const eventNameInput = document.getElementById(\"event-name\");\n  const eventLocationInput = document.getElementById(\"event-location\");\n  const eventDetailsInput = document.getElementById(\"event-details\");\n  const eventDurationSelect = document.getElementById(\"event-duration\");\n  const customDurationGroup = document.getElementById(\"custom-duration-group\");\n  const customDurationInput = document.getElementById(\"custom-duration\");\n  const inviteesContainer = document.getElementById(\"invitees-container\");\n  const addInviteeButton = document.getElementById(\"add-invitee\");\n  const generateButton = document.getElementById(\"generate\");\n  const allDayCheckbox = document.getElementById(\"all-day-event\");\n  const timedEventFields = document.getElementById(\"timed-event-fields\");\n  const durationFields = document.getElementById(\"duration-fields\");\n  const endtimeFields = document.getElementById(\"endtime-fields\");\n  const endTypeRadios = document.getElementsByName(\"end-type\");\n  const baseTzSearch = document.getElementById(\"base-tz-search\");\n  const tzTableContainer = document.getElementById(\"tz-table-container\");\n  const tzTable = document.getElementById(\"tz-table\");\n  const tzTableBody = tzTable ? tzTable.querySelector(\"tbody\") : null;\n  const originTzHeader = document.getElementById(\"origin-tz-header\");\n  const targetTzHeader = document.getElementById(\"target-tz-header\");\n  const additionalTimezonesContainer = document.getElementById(\n    \"additional-timezones\"\n  );\n  const addTimezoneButton = document.getElementById(\"add-timezone\");\n\n  // Set default date to today\n  dateInput.valueAsDate = new Date();\n  if (endDateInput) endDateInput.valueAsDate = new Date();\n\n  // Common city timezones to ensure they're included\n  const commonCityTimezones = [\n    \"Asia/Tel_Aviv\",\n    \"Asia/Jerusalem\",\n    \"America/New_York\",\n    \"America/Los_Angeles\",\n    \"America/Chicago\",\n    \"Europe/London\",\n    \"Europe/Paris\",\n    \"Europe/Berlin\",\n    \"Asia/Tokyo\",\n    \"Asia/Shanghai\",\n    \"Asia/Singapore\",\n    \"Australia/Sydney\",\n    \"Pacific/Auckland\",\n    \"Asia/Dubai\",\n    \"Asia/Kolkata\",\n    \"Europe/Moscow\",\n    \"America/Sao_Paulo\",\n    \"Africa/Johannesburg\",\n    \"Asia/Bangkok\",\n    \"Asia/Seoul\",\n  ];\n\n  // Get GMT offset for a timezone\n  function getGMTOffset(timezone) {\n    try {\n      const now = DateTime.now().setZone(timezone);\n      const offset = now.toFormat(\"ZZZZ\");\n      return offset;\n    } catch (e) {\n      return \"Unknown\";\n    }\n  }\n\n  // Format timezone option text with GMT offset and pretty city name\n  function formatTimezoneOption(timezone) {\n    const offset = getGMTOffset(timezone);\n    // Replace underscores with spaces for display\n    const prettyTz = timezone.replace(/_/g, \" \");\n    return `${prettyTz} (${offset})`;\n  }\n\n  // Detect user's timezone with fallbacks\n  function detectUserTimezone() {\n    try {\n      const browserTz = Intl.DateTimeFormat().resolvedOptions().timeZone;\n      if (browserTz) return browserTz;\n    } catch (e) {\n      console.warn(\"Browser timezone detection failed:\", e);\n    }\n    try {\n      const date = new Date();\n      const offset = -date.getTimezoneOffset();\n      const hours = Math.floor(Math.abs(offset) / 60);\n      const minutes = Math.abs(offset) % 60;\n      const sign = offset >= 0 ? \"+\" : \"-\";\n      const gmtOffset = `GMT${sign}${hours\n        .toString()\n        .padStart(2, \"0\")}:${minutes.toString().padStart(2, \"0\")}`;\n      const matchingTz = commonCityTimezones.find((tz) => {\n        try {\n          return DateTime.now().setZone(tz).toFormat(\"ZZZZ\") === gmtOffset;\n        } catch (e) {\n          return false;\n        }\n      });\n      if (matchingTz) return matchingTz;\n    } catch (e) {\n      console.warn(\"System time fallback failed:\", e);\n    }\n    return \"America/New_York\";\n  }\n\n  // Get all available timezones\n  let allTimeZones = [];\n  try {\n    allTimeZones = Intl.supportedValuesOf(\"timeZone\");\n  } catch (e) {\n    console.warn(\"Failed to get supported timezones:\", e);\n    allTimeZones = commonCityTimezones;\n  }\n  allTimeZones = [...new Set([...commonCityTimezones, ...allTimeZones])];\n  allTimeZones.sort();\n\n  // Populate time zones\n  function populateTimeZones() {\n    const userTimezone = detectUserTimezone();\n    // Populate both selects\n    allTimeZones.forEach((tz) => {\n      const baseOption = document.createElement(\"option\");\n      const targetOption = document.createElement(\"option\");\n      baseOption.value = targetOption.value = tz;\n      baseOption.textContent = targetOption.textContent =\n        formatTimezoneOption(tz);\n      // Store searchable text for each option (with and without underscores)\n      baseOption.setAttribute(\n        \"data-search\",\n        `${tz.toLowerCase()} ${tz.replace(/_/g, \" \").toLowerCase()}`\n      );\n      targetOption.setAttribute(\n        \"data-search\",\n        `${tz.toLowerCase()} ${tz.replace(/_/g, \" \").toLowerCase()}`\n      );\n      baseTzSelect.appendChild(baseOption);\n      targetTzSelect.appendChild(targetOption);\n    });\n    baseTzSelect.value = userTimezone;\n    targetTzSelect.value = \"UTC\";\n    updateTzSelectedFeedback();\n    generateTzTable();\n  }\n\n  // --- Target Time Zone Selection Feedback ---\n  function updateTzSelectedFeedback() {\n    const selected = targetTzSelect.options[targetTzSelect.selectedIndex];\n    if (selected) {\n      tzSelectedFeedback.textContent = `Selected: ${selected.textContent}`;\n    } else {\n      tzSelectedFeedback.textContent = \"\";\n    }\n  }\n\n  // When user clicks or changes selection in the target time zone\n  targetTzSelect.addEventListener(\"change\", () => {\n    collapseTargetList();\n    updateTzSelectedFeedback();\n    generateTzTable();\n  });\n  targetTzSelect.addEventListener(\"click\", () => {\n    collapseTargetList();\n    updateTzSelectedFeedback();\n    generateTzTable();\n  });\n  targetTzSelect.addEventListener(\"keyup\", () => {\n    updateTzSelectedFeedback();\n    generateTzTable();\n  });\n\n  // When user types in the search, filter and auto-select first visible\n  timezoneSearch.addEventListener(\"input\", (e) => {\n    filterTimezones(e.target.value);\n    // Auto-select first visible option\n    const firstVisible = Array.from(targetTzSelect.options).find(\n      (opt) => opt.style.display !== \"none\"\n    );\n    if (firstVisible) {\n      targetTzSelect.value = firstVisible.value;\n      updateTzSelectedFeedback();\n    }\n  });\n\n  function filterTimezones(searchTerm) {\n    const options = targetTzSelect.options;\n    searchTerm = searchTerm.toLowerCase().replace(/ /g, \"_\");\n    for (let i = 0; i < options.length; i++) {\n      const option = options[i];\n      // Search both the original and pretty version\n      const searchAttr = option.getAttribute(\"data-search\");\n      const prettyText = option.textContent.toLowerCase();\n      // Allow search by either underscores or spaces\n      const searchMatch =\n        searchAttr.includes(searchTerm.replace(/_/g, \" \")) ||\n        searchAttr.includes(searchTerm) ||\n        prettyText.includes(searchTerm.replace(/_/g, \" \")) ||\n        prettyText.includes(searchTerm);\n      option.style.display = searchMatch ? \"\" : \"none\";\n    }\n  }\n\n  // --- All Day Event Logic ---\n  allDayCheckbox.addEventListener(\"change\", function () {\n    if (allDayCheckbox.checked) {\n      timedEventFields.setAttribute(\"hidden\", \"\");\n    } else {\n      timedEventFields.removeAttribute(\"hidden\");\n    }\n  });\n\n  // --- Duration vs End Time Toggle ---\n  function updateEndTypeFields() {\n    const endType = Array.from(endTypeRadios).find((r) => r.checked).value;\n    if (endType === \"duration\") {\n      durationFields.removeAttribute(\"hidden\");\n      endtimeFields.setAttribute(\"hidden\", \"\");\n    } else {\n      durationFields.setAttribute(\"hidden\", \"\");\n      endtimeFields.removeAttribute(\"hidden\");\n      // Always set end date to start date if not set\n      if (\n        dateInput.value &&\n        (!endDateInput.value || endDateInput.value < dateInput.value)\n      ) {\n        endDateInput.value = dateInput.value;\n      }\n    }\n  }\n  endTypeRadios.forEach((radio) =>\n    radio.addEventListener(\"change\", updateEndTypeFields)\n  );\n  // Ensure correct fields are shown on page load\n  updateEndTypeFields();\n\n  // --- End Date Auto-Update Logic ---\n  function updateEndDateIfNeeded() {\n    if (!dateInput.value || !timeInput.value) return;\n    if (!endTimeInput.value) return;\n    const start = DateTime.fromFormat(\n      `${dateInput.value} ${timeInput.value}`,\n      \"yyyy-MM-dd HH:mm\"\n    );\n    const end = DateTime.fromFormat(\n      `${endDateInput.value} ${endTimeInput.value}`,\n      \"yyyy-MM-dd HH:mm\"\n    );\n    if (end < start) {\n      // If end is before start, set end date to next day\n      const nextDay = start.plus({ days: 1 }).toFormat(\"yyyy-MM-dd\");\n      endDateInput.value = nextDay;\n    }\n  }\n  if (endTimeInput && endDateInput) {\n    timeInput.addEventListener(\"change\", updateEndDateIfNeeded);\n    dateInput.addEventListener(\"change\", function () {\n      endDateInput.value = dateInput.value;\n      updateEndDateIfNeeded();\n    });\n    endTimeInput.addEventListener(\"change\", updateEndDateIfNeeded);\n  }\n\n  eventDurationSelect.addEventListener(\"change\", () => {\n    customDurationGroup.style.display =\n      eventDurationSelect.value === \"custom\" ? \"block\" : \"none\";\n  });\n\n  function addInviteeRow() {\n    const row = document.createElement(\"div\");\n    row.className = \"invitee-row\";\n    const emailInput = document.createElement(\"input\");\n    emailInput.type = \"email\";\n    emailInput.className = \"invitee-email\";\n    emailInput.placeholder = \"email@example.com\";\n    const removeButton = document.createElement(\"button\");\n    removeButton.type = \"button\";\n    removeButton.className = \"remove-invitee\";\n    removeButton.textContent = \"×\";\n    removeButton.style.display = \"block\";\n    removeButton.addEventListener(\"click\", () => {\n      row.remove();\n      updateRemoveButtons();\n    });\n    row.appendChild(emailInput);\n    row.appendChild(removeButton);\n    inviteesContainer.appendChild(row);\n    updateRemoveButtons();\n  }\n\n  function updateRemoveButtons() {\n    const rows = inviteesContainer.querySelectorAll(\".invitee-row\");\n    rows.forEach((row) => {\n      const removeButton = row.querySelector(\".remove-invitee\");\n      removeButton.style.display = rows.length > 1 ? \"block\" : \"none\";\n    });\n  }\n\n  addInviteeButton.addEventListener(\"click\", addInviteeRow);\n\n  function generateICS() {\n    // All Day Event\n    if (allDayCheckbox.checked) {\n      const eventName = eventNameInput.value;\n      const eventLocation = eventLocationInput.value;\n      const eventDetails = eventDetailsInput.value;\n      const baseTz = baseTzSelect.value;\n      const targetTz = targetTzSelect.value;\n      const date = dateInput.value;\n      const invitees = Array.from(document.querySelectorAll(\".invitee-email\"))\n        .map((input) => input.value)\n        .filter((email) => email.trim() !== \"\");\n      // All day event: DTSTART/DTEND as DATE only\n      const icsContent = [\n        \"BEGIN:VCALENDAR\",\n        \"VERSION:2.0\",\n        \"PRODID:-//TimeSync//EN\",\n        \"CALSCALE:GREGORIAN\",\n        \"BEGIN:VEVENT\",\n        `DTSTART;VALUE=DATE:${date.replace(/-/g, \"\")}`,\n        `DTEND;VALUE=DATE:${date.replace(/-/g, \"\")}`,\n        `SUMMARY:${eventName}`,\n        `LOCATION:${eventLocation}`,\n        `DESCRIPTION:${eventDetails}`,\n        ...invitees.map(\n          (email) => `ATTENDEE;RSVP=TRUE;ROLE=REQ-PARTICIPANT:mailto:${email}`\n        ),\n        \"END:VEVENT\",\n        \"END:VCALENDAR\",\n      ].join(\"\\r\\n\");\n      const blob = new Blob([icsContent], {\n        type: \"text/calendar;charset=utf-8\",\n      });\n      const link = document.createElement(\"a\");\n      link.href = URL.createObjectURL(blob);\n      link.download = `${eventName\n        .replace(/[^a-z0-9]/gi, \"_\")\n        .toLowerCase()}.ics`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      return;\n    }\n    // Timed Event\n    const eventName = eventNameInput.value;\n    const eventLocation = eventLocationInput.value;\n    const eventDetails = eventDetailsInput.value;\n    const baseTz = baseTzSelect.value;\n    const targetTz = targetTzSelect.value;\n    const date = dateInput.value;\n    const time = timeInput.value;\n    let startTime = DateTime.fromFormat(`${date} ${time}`, \"yyyy-MM-dd HH:mm\", {\n      zone: baseTz,\n    });\n    let endTime;\n    let endDate;\n    // Duration or End Time\n    const endType = Array.from(endTypeRadios).find((r) => r.checked).value;\n    if (endType === \"duration\") {\n      let durationMinutes = parseInt(eventDurationSelect.value);\n      if (eventDurationSelect.value === \"custom\") {\n        durationMinutes = parseInt(customDurationInput.value);\n      }\n      endTime = startTime.plus({ minutes: durationMinutes });\n      endDate = endTime.toFormat(\"yyyy-MM-dd\");\n    } else {\n      // End time and end date\n      const endDateVal = endDateInput.value || date;\n      const endTimeVal = endTimeInput.value || time;\n      endTime = DateTime.fromFormat(\n        `${endDateVal} ${endTimeVal}`,\n        \"yyyy-MM-dd HH:mm\",\n        { zone: baseTz }\n      );\n      endDate = endDateVal;\n      // If end is before start, auto-increment end date\n      if (endTime < startTime) {\n        endTime = startTime.plus({ days: 1 });\n        endDate = endTime.toFormat(\"yyyy-MM-dd\");\n      }\n    }\n    // Convert to target timezone\n    const targetStartTime = startTime.setZone(targetTz);\n    const targetEndTime = endTime.setZone(targetTz);\n    const invitees = Array.from(document.querySelectorAll(\".invitee-email\"))\n      .map((input) => input.value)\n      .filter((email) => email.trim() !== \"\");\n    const icsContent = [\n      \"BEGIN:VCALENDAR\",\n      \"VERSION:2.0\",\n      \"PRODID:-//TimeSync//EN\",\n      \"CALSCALE:GREGORIAN\",\n      \"BEGIN:VEVENT\",\n      `DTSTART;TZID=${targetTz}:${targetStartTime.toFormat(\n        \"yyyyMMdd'T'HHmmss\"\n      )}`,\n      `DTEND;TZID=${targetTz}:${targetEndTime.toFormat(\"yyyyMMdd'T'HHmmss\")}`,\n      `SUMMARY:${eventName}`,\n      `LOCATION:${eventLocation}`,\n      `DESCRIPTION:${eventDetails}`,\n      ...invitees.map(\n        (email) => `ATTENDEE;RSVP=TRUE;ROLE=REQ-PARTICIPANT:mailto:${email}`\n      ),\n      \"END:VEVENT\",\n      \"END:VCALENDAR\",\n    ].join(\"\\r\\n\");\n    const blob = new Blob([icsContent], {\n      type: \"text/calendar;charset=utf-8\",\n    });\n    const link = document.createElement(\"a\");\n    link.href = URL.createObjectURL(blob);\n    link.download = `${eventName\n      .replace(/[^a-z0-9]/gi, \"_\")\n      .toLowerCase()}.ics`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n\n  populateTimeZones();\n  generateButton.addEventListener(\"click\", generateICS);\n  updateEndTypeFields();\n\n  // --- Base Time Zone Search ---\n  function filterBaseTimezones(searchTerm) {\n    const options = baseTzSelect.options;\n    searchTerm = searchTerm.toLowerCase().replace(/ /g, \"_\");\n    for (let i = 0; i < options.length; i++) {\n      const option = options[i];\n      const searchAttr = option.getAttribute(\"data-search\");\n      const prettyText = option.textContent.toLowerCase();\n      const searchMatch =\n        searchAttr.includes(searchTerm.replace(/_/g, \" \")) ||\n        searchAttr.includes(searchTerm) ||\n        prettyText.includes(searchTerm.replace(/_/g, \" \")) ||\n        prettyText.includes(searchTerm);\n      option.style.display = searchMatch ? \"\" : \"none\";\n    }\n  }\n  baseTzSearch.addEventListener(\"input\", (e) => {\n    filterBaseTimezones(e.target.value);\n    // Auto-select first visible option\n    const firstVisible = Array.from(baseTzSelect.options).find(\n      (opt) => opt.style.display !== \"none\"\n    );\n    if (firstVisible) {\n      baseTzSelect.value = firstVisible.value;\n    }\n  });\n  // Close search bar on selection\n  baseTzSelect.addEventListener(\"change\", function () {\n    baseTzSearch.value = \"\";\n    baseTzSearch.blur();\n  });\n  baseTzSelect.addEventListener(\"click\", function () {\n    baseTzSearch.value = \"\";\n    baseTzSearch.blur();\n  });\n  baseTzSelect.addEventListener(\"keyup\", function (e) {\n    if (e.key === \"Enter\" || e.key === \"Tab\") {\n      baseTzSearch.value = \"\";\n      baseTzSearch.blur();\n    }\n  });\n\n  // Helper to collapse/expand target select\n  function showTargetSelect(expand) {\n    if (expand) {\n      targetTzSelect.size = 5;\n      targetTzSelect.style.display = \"\";\n    } else {\n      targetTzSelect.size = 1;\n      targetTzSelect.style.display = \"\";\n    }\n  }\n\n  // Expand list when searching\n  timezoneSearch.addEventListener(\"focus\", () => showTargetSelect(true));\n  timezoneSearch.addEventListener(\"input\", () => showTargetSelect(true));\n  // Collapse list when a timezone is chosen\n  function collapseTargetList() {\n    showTargetSelect(false);\n    timezoneSearch.value = \"\";\n    timezoneSearch.blur();\n  }\n\n  // --- Time Zone Comparison Table ---\n  function generateTzTable() {\n    if (!tzTableBody) return;\n    tzTableBody.innerHTML = \"\";\n    const originTz = baseTzSelect.value;\n    const targetTz = targetTzSelect.value;\n    const additionalTzs = Array.from(\n      document.querySelectorAll(\".timezone-select\")\n    ).map((select) => select.value);\n    let date = dateInput.value;\n    if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(date)) {\n      date = DateTime.now().toFormat(\"yyyy-MM-dd\");\n    }\n\n    // Update headers\n    const headerRow = document.createElement(\"tr\");\n    const originHeader = document.createElement(\"th\");\n    originHeader.textContent = formatTimezoneOption(originTz);\n    headerRow.appendChild(originHeader);\n\n    const targetHeader = document.createElement(\"th\");\n    targetHeader.textContent = formatTimezoneOption(targetTz);\n    headerRow.appendChild(targetHeader);\n\n    additionalTzs.forEach((tz) => {\n      const th = document.createElement(\"th\");\n      th.textContent = formatTimezoneOption(tz);\n      headerRow.appendChild(th);\n    });\n\n    tzTable.querySelector(\"thead\").innerHTML = \"\";\n    tzTable.querySelector(\"thead\").appendChild(headerRow);\n\n    // Starting point: midnight in origin tz\n    let startOfDay = DateTime.fromFormat(`${date} 00:00`, \"yyyy-MM-dd HH:mm\", {\n      zone: originTz,\n    });\n    if (!startOfDay.isValid) {\n      startOfDay = DateTime.now().setZone(originTz).startOf(\"day\");\n    }\n\n    // Determine selected row index for highlighting\n    let selectedRowIndex = -1;\n    if (timeInput.value) {\n      const selectedTime = DateTime.fromFormat(\n        `${date} ${timeInput.value}`,\n        \"yyyy-MM-dd HH:mm\",\n        { zone: originTz }\n      );\n      if (selectedTime.isValid) {\n        const diffMinutes = selectedTime.diff(startOfDay, \"minutes\").minutes;\n        selectedRowIndex = Math.round(diffMinutes / 15);\n      }\n    }\n\n    const rowsFragment = document.createDocumentFragment();\n    for (let i = 0; i < 96; i++) {\n      const originTime = startOfDay.plus({ minutes: 15 * i });\n      const tr = document.createElement(\"tr\");\n      tr.dataset.index = i;\n      const inSelectedRange = selectedRowIndex !== -1 && i === selectedRowIndex;\n      if (inSelectedRange) tr.classList.add(\"selected\");\n\n      // Origin time\n      const tdOrigin = document.createElement(\"td\");\n      tdOrigin.textContent = originTime.toFormat(\"HH:mm\");\n      tr.appendChild(tdOrigin);\n\n      // Target time\n      const tdTarget = document.createElement(\"td\");\n      tdTarget.textContent = originTime.setZone(targetTz).toFormat(\"HH:mm\");\n      tr.appendChild(tdTarget);\n\n      // Additional timezones\n      additionalTzs.forEach((tz) => {\n        const td = document.createElement(\"td\");\n        td.textContent = originTime.setZone(tz).toFormat(\"HH:mm\");\n        tr.appendChild(td);\n      });\n\n      const clickHandler = () => {\n        selectedStartIndex = i;\n        selectedEndIndex = i;\n        timeInput.value = originTime.toFormat(\"HH:mm\");\n        dateInput.value = originTime.toFormat(\"yyyy-MM-dd\");\n        const nextTime = originTime.plus({ minutes: 15 });\n        endTimeInput.value = nextTime.toFormat(\"HH:mm\");\n        endDateInput.value = nextTime.toFormat(\"yyyy-MM-dd\");\n        document.querySelector(\n          'input[name=\"end-type\"][value=\"endtime\"]'\n        ).checked = true;\n        updateEndTypeFields();\n        generateTzTable();\n      };\n      tr.addEventListener(\"click\", clickHandler);\n      rowsFragment.appendChild(tr);\n    }\n    tzTableBody.appendChild(rowsFragment);\n  }\n\n  // Regenerate table on relevant changes\n  [baseTzSelect, targetTzSelect, dateInput].forEach((el) => {\n    if (el) el.addEventListener(\"change\", generateTzTable);\n  });\n  if (timeInput) timeInput.addEventListener(\"change\", generateTzTable);\n\n  // Also regenerate on search selection\n  baseTzSelect.addEventListener(\"change\", generateTzTable);\n  targetTzSelect.addEventListener(\"change\", generateTzTable);\n  dateInput.addEventListener(\"change\", generateTzTable);\n\n  // Variables for drag selection\n  let dragStartIndex = null;\n  let dragCurrentIndex = null;\n  let isDragging = false;\n  let selectedStartIndex = null;\n  let selectedEndIndex = null;\n\n  function updateRangeHighlight() {\n    Array.from(tzTableBody.children).forEach((row) => {\n      const idx = parseInt(row.dataset.index, 10);\n      const inDragRange =\n        isDragging &&\n        dragStartIndex !== null &&\n        dragCurrentIndex !== null &&\n        idx >= Math.min(dragStartIndex, dragCurrentIndex) &&\n        idx <= Math.max(dragStartIndex, dragCurrentIndex);\n      const inSelectedRange =\n        selectedStartIndex !== null &&\n        selectedEndIndex !== null &&\n        idx >= selectedStartIndex &&\n        idx <= selectedEndIndex;\n      row.classList.toggle(\"range-selected\", inDragRange || inSelectedRange);\n    });\n  }\n\n  function finalizeSelection() {\n    if (dragStartIndex === null || dragCurrentIndex === null) return;\n    selectedStartIndex = Math.min(dragStartIndex, dragCurrentIndex);\n    selectedEndIndex = Math.max(dragStartIndex, dragCurrentIndex);\n\n    const originTz = baseTzSelect.value;\n    let date = dateInput.value;\n    if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(date)) {\n      date = DateTime.now().toFormat(\"yyyy-MM-dd\");\n    }\n    let startOfDay = DateTime.fromFormat(`${date} 00:00`, \"yyyy-MM-dd HH:mm\", {\n      zone: originTz,\n    });\n    if (!startOfDay.isValid)\n      startOfDay = DateTime.now().setZone(originTz).startOf(\"day\");\n\n    const startTime = startOfDay.plus({ minutes: 15 * selectedStartIndex });\n    const endTime = startOfDay.plus({ minutes: 15 * (selectedEndIndex + 1) });\n\n    // Update form fields\n    timeInput.value = startTime.toFormat(\"HH:mm\");\n    dateInput.value = startTime.toFormat(\"yyyy-MM-dd\");\n    endTimeInput.value = endTime.toFormat(\"HH:mm\");\n    endDateInput.value = endTime.toFormat(\"yyyy-MM-dd\");\n\n    // Switch to End Time mode\n    document.querySelector(\n      'input[name=\"end-type\"][value=\"endtime\"]'\n    ).checked = true;\n    updateEndTypeFields();\n\n    generateTzTable(); // refresh highlights\n  }\n\n  // Event delegation for drag selection\n  tzTableBody.addEventListener(\"mousedown\", (e) => {\n    const tr = e.target.closest(\"tr\");\n    if (!tr) return;\n    isDragging = true;\n    dragStartIndex = parseInt(tr.dataset.index, 10);\n    dragCurrentIndex = dragStartIndex;\n    updateRangeHighlight();\n  });\n\n  tzTableBody.addEventListener(\"mouseover\", (e) => {\n    if (!isDragging) return;\n    const tr = e.target.closest(\"tr\");\n    if (!tr) return;\n    dragCurrentIndex = parseInt(tr.dataset.index, 10);\n    updateRangeHighlight();\n  });\n\n  document.addEventListener(\"mouseup\", () => {\n    if (!isDragging) return;\n    isDragging = false;\n    finalizeSelection();\n    dragStartIndex = dragCurrentIndex = null;\n  });\n\n  // Add timezone row\n  function addTimezoneRow() {\n    const timezoneId = `tz-${Date.now()}`;\n    const row = document.createElement(\"div\");\n    row.className = \"field-group additional-timezone\";\n    row.innerHTML = `\n      <div class=\"timezone-header\">\n        <label>Additional Time Zone</label>\n        <button type=\"button\" class=\"remove-timezone\" data-timezone=\"${timezoneId}\">×</button>\n      </div>\n      <input type=\"text\" class=\"timezone-search\" placeholder=\"Search timezone...\" />\n      <select class=\"timezone-select\" id=\"${timezoneId}\" size=\"5\"></select>\n      <div class=\"tz-selected-feedback\"></div>\n    `;\n\n    // Populate the select with timezones\n    const select = row.querySelector(\".timezone-select\");\n    allTimeZones.forEach((tz) => {\n      const option = document.createElement(\"option\");\n      option.value = tz;\n      option.textContent = formatTimezoneOption(tz);\n      option.setAttribute(\n        \"data-search\",\n        `${tz.toLowerCase()} ${tz.replace(/_/g, \" \").toLowerCase()}`\n      );\n      select.appendChild(option);\n    });\n\n    // Add event listeners\n    const searchInput = row.querySelector(\".timezone-search\");\n    const removeButton = row.querySelector(\".remove-timezone\");\n    const feedback = row.querySelector(\".tz-selected-feedback\");\n\n    searchInput.addEventListener(\"input\", (e) => {\n      filterAdditionalTimezone(e.target.value, select);\n      const firstVisible = Array.from(select.options).find(\n        (opt) => opt.style.display !== \"none\"\n      );\n      if (firstVisible) {\n        select.value = firstVisible.value;\n        feedback.textContent = `Selected: ${firstVisible.textContent}`;\n        generateTzTable();\n      }\n    });\n\n    removeButton.addEventListener(\"click\", () => {\n      row.remove();\n      generateTzTable();\n    });\n\n    select.addEventListener(\"change\", () => {\n      const selected = select.options[select.selectedIndex];\n      if (selected) {\n        feedback.textContent = `Selected: ${selected.textContent}`;\n        generateTzTable();\n      }\n    });\n\n    additionalTimezonesContainer.appendChild(row);\n    generateTzTable();\n  }\n\n  function filterAdditionalTimezone(searchTerm, select) {\n    const options = select.options;\n    searchTerm = searchTerm.toLowerCase().replace(/ /g, \"_\");\n    for (let i = 0; i < options.length; i++) {\n      const option = options[i];\n      const searchAttr = option.getAttribute(\"data-search\");\n      const prettyText = option.textContent.toLowerCase();\n      const searchMatch =\n        searchAttr.includes(searchTerm.replace(/_/g, \" \")) ||\n        searchAttr.includes(searchTerm) ||\n        prettyText.includes(searchTerm.replace(/_/g, \" \")) ||\n        prettyText.includes(searchTerm);\n      option.style.display = searchMatch ? \"\" : \"none\";\n    }\n  }\n\n  // Add event listener for the add timezone button\n  addTimezoneButton.addEventListener(\"click\", addTimezoneRow);\n})();\n"],"names":["DateTime","baseTzSelect","targetTzSelect","timezoneSearch","tzSelectedFeedback","dateInput","timeInput","endDateInput","endTimeInput","eventNameInput","eventLocationInput","eventDetailsInput","eventDurationSelect","customDurationGroup","customDurationInput","inviteesContainer","addInviteeButton","generateButton","allDayCheckbox","timedEventFields","durationFields","endtimeFields","endTypeRadios","baseTzSearch","tzTable","tzTableBody","additionalTimezonesContainer","addTimezoneButton","commonCityTimezones","getGMTOffset","timezone","formatTimezoneOption","offset","detectUserTimezone","browserTz","hours","minutes","gmtOffset","matchingTz","tz","allTimeZones","populateTimeZones","userTimezone","baseOption","targetOption","updateTzSelectedFeedback","generateTzTable","selected","collapseTargetList","filterTimezones","firstVisible","opt","searchTerm","options","i","option","searchAttr","prettyText","searchMatch","updateEndTypeFields","r","radio","updateEndDateIfNeeded","start","nextDay","addInviteeRow","row","emailInput","removeButton","updateRemoveButtons","rows","generateICS","eventName","eventLocation","eventDetails","date","invitees","input","email","icsContent","blob","link","baseTz","targetTz","time","startTime","endTime","durationMinutes","endDateVal","endTimeVal","targetStartTime","targetEndTime","filterBaseTimezones","showTargetSelect","expand","originTz","additionalTzs","select","headerRow","originHeader","targetHeader","th","startOfDay","selectedRowIndex","selectedTime","diffMinutes","rowsFragment","originTime","tr","tdOrigin","tdTarget","td","clickHandler","selectedStartIndex","selectedEndIndex","nextTime","el","dragStartIndex","dragCurrentIndex","isDragging","updateRangeHighlight","idx","inDragRange","inSelectedRange","finalizeSelection","addTimezoneRow","timezoneId","searchInput","feedback","e","filterAdditionalTimezone"],"mappings":"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"}